<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>SASO | Student Profile</title>
<link rel="icon" type="image/jpg" href="school logo.jpg"/>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root {
  --primary: #059669;
  --primary-dark: #047857;
  --primary-light: #10b981;
  --danger: #dc2626;
  --warning: #d97706;
  --success: #10b981;
  --bg: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
  --card: #ffffff;
  --radius: 20px;
  --shadow: 0 10px 30px rgba(5, 150, 105, 0.1);
  --shadow-hover: 0 15px 40px rgba(5, 150, 105, 0.2);
  --shadow-3d: 0 10px 20px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 0, 0, 0.05);
  --shadow-inset: inset 0 2px 4px rgba(0, 0, 0, 0.05);
}
* {
  box-sizing: border-box;
  font-family: 'Plus Jakarta Sans', sans-serif;
  -webkit-tap-highlight-color: transparent;
}
body {
  background: var(--bg);
  margin: 0;
  padding: 12px;
  color: #1e293b;
  min-height: 100vh;
}
.container {
  max-width: 500px;
  margin: auto;
  background: var(--card);
  padding: 25px;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  border: 1px solid rgba(5, 150, 105, 0.1);
  position: relative;
  overflow: hidden;
}
.container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 6px;
  background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
  border-radius: var(--radius) var(--radius) 0 0;
}
/* Header Section */
.header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 25px;
  position: relative;
}
.header h2 {
  margin: 0;
  font-weight: 800;
  font-size: 1.5rem;
  color: #0f172a;
  background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 2px 4px rgba(5, 150, 105, 0.1);
}
.id-badge {
  background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
  padding: 6px 14px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.8rem;
  color: var(--primary-dark);
  border: 1px solid rgba(5, 150, 105, 0.2);
  box-shadow: var(--shadow-inset);
  display: inline-block;
  margin-top: 5px;
}
.header-icon {
  color: var(--primary);
  filter: drop-shadow(0 4px 6px rgba(5, 150, 105, 0.2));
  transition: transform 0.3s ease;
}
.header-icon:hover {
  transform: scale(1.05);
}
/* Offense Summary Badges - 3D effect */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
  margin-bottom: 25px;
}
.stat-card {
  padding: 16px 12px;
  border-radius: 16px;
  text-align: center;
  font-weight: 700;
  font-size: 0.75rem;
  text-transform: uppercase;
  box-shadow: var(--shadow-3d);
  transition: all 0.3s ease;
  border: 1px solid rgba(255, 255, 255, 0.3);
  position: relative;
  overflow: hidden;
  transform: translateY(0);
}
.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-hover);
}
.stat-card span {
  display: block;
  font-size: 1.8rem;
  margin-bottom: 4px;
  font-weight: 800;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
.s-major {
  background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
  color: #991b1b;
  border-top: 4px solid #f87171;
}
.s-minor {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  color: #92400e;
  border-top: 4px solid #f59e0b;
}
.s-total {
  background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
  color: var(--primary-dark);
  border-top: 4px solid var(--primary);
}
/* Mobile Buttons */
.btn-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
  margin-bottom: 25px;
}
.btn {
  border: none;
  padding: 16px 8px;
  border-radius: 14px;
  color: white;
  font-weight: 700;
  font-size: 0.85rem;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  transition: all 0.3s ease;
  box-shadow: var(--shadow-3d);
  position: relative;
  overflow: hidden;
  transform: translateY(0);
}
.btn:hover {
  transform: translateY(-3px);
}
.btn:active {
  transform: translateY(1px);
}
.btn-add {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  border-bottom: 4px solid var(--primary-dark);
}
.btn-edit {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  border-bottom: 4px solid #d97706;
}
.btn-delete {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  border-bottom: 4px solid #dc2626;
}
.btn-back {
  background: linear-gradient(135deg, #64748b 0%, #475569 100%);
  border-bottom: 4px solid #475569;
  width: 100%;
  flex-direction: row;
  justify-content: center;
  margin-top: 20px;
  padding: 16px;
}
.btn i {
  font-size: 1.4rem;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}
/* Data Rows */
.info-box {
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  border-radius: 18px;
  padding: 10px 20px;
  border: 1px solid rgba(5, 150, 105, 0.15);
  box-shadow: var(--shadow-inset);
}
.info-row {
  padding: 16px 0;
  border-bottom: 1px solid #e2e8f0;
  transition: padding 0.2s ease;
}
.info-row:last-child {
  border-bottom: none;
}
.info-row:hover {
  padding-left: 5px;
}
.info-label {
  font-size: 0.7rem;
  font-weight: 800;
  color: var(--primary-dark);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.info-label::before {
  content: '';
  display: inline-block;
  width: 6px;
  height: 6px;
  background: var(--primary);
  border-radius: 50%;
}
.info-value {
  font-size: 1rem;
  font-weight: 600;
  color: #1e293b;
  margin-top: 4px;
  word-break: break-word;
  padding-left: 12px;
}
/* Modal Styles - 3D effects */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(6px);
  z-index: 1000;
  padding: 10px;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease;
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.modal-content {
  background: white;
  width: 100%;
  max-width: 420px;
  border-radius: 24px;
  padding: 25px;
  max-height: 85vh;
  overflow-y: auto;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(5, 150, 105, 0.2);
  transform: translateY(0);
  animation: slideUp 0.4s ease;
}
@keyframes slideUp {
  from { transform: translateY(30px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
.modal-header {
  text-align: center;
  margin-bottom: 25px;
}
.modal-header i {
  font-size: 2.5rem;
  margin-bottom: 12px;
  filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
}
.modal-header h3 {
  margin: 0;
  font-weight: 800;
  color: #0f172a;
  background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.form-group {
  margin-bottom: 20px;
}
.form-group label {
  display: block;
  font-weight: 700;
  font-size: 0.85rem;
  color: var(--primary-dark);
  margin-bottom: 8px;
  padding-left: 4px;
}
input, select, textarea {
  width: 100%;
  padding: 14px;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  font-size: 16px;
  background: #f8fafc;
  outline: none;
  transition: all 0.3s ease;
  box-shadow: var(--shadow-inset);
}
input:focus, select:focus, textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
}
textarea {
  height: 100px;
  resize: none;
  font-size: 0.9rem;
}
.modal-footer {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 25px;
}
.hidden {
  display: none !important;
}
/* Floating elements for 3D effect */
.floating {
  animation: float 3s ease-in-out infinite;
}
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
/* Badge for student ID */
.id-badge-container {
  position: relative;
  display: inline-block;
}
.id-badge-container::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(5, 150, 105, 0.1) 0%, transparent 100%);
  border-radius: 20px;
  transform: translate(-50%, -50%) scale(1.1);
  z-index: -1;
}
</style>
</head>

<body>
<div class="container">
  <div class="header">
    <div>
      <h2>Student Profile</h2>
      <div class="id-badge-container">
        <div id="studentIdDisplay" class="id-badge floating"></div>
      </div>
    </div>
    <i class="fas fa-user-circle fa-3x header-icon floating"></i>
  </div>

  <div class="stats-grid">
    <div class="stat-card s-major"><span id="majorCount">0</span> Major</div>
    <div class="stat-card s-minor"><span id="minorCount">0</span> Minor</div>
    <div class="stat-card s-total"><span id="totalCount">0</span> Total</div>
  </div>

  <div class="btn-grid">
    <button id="addOffenseBtn" class="btn btn-add"><i class="fas fa-plus-circle"></i> Offense</button>
    <button id="editRecordBtn" class="btn btn-edit"><i class="fas fa-user-edit"></i> Info</button>
    <button id="deleteRecordBtn" class="btn btn-delete"><i class="fas fa-trash"></i> Delete</button>
  </div>

  <div class="info-box">
    <div class="info-row"><div class="info-label">Full Name</div><div class="info-value" id="name">---</div></div>
    <div class="info-row"><div class="info-label">Student No.</div><div class="info-value" id="student_number">---</div></div>
    <div class="info-row"><div class="info-label">Course</div><div class="info-value" id="course">---</div></div>
    <div class="info-row"><div class="info-label">Email</div><div class="info-value" id="cca_email">---</div></div>
    <div class="info-row"><div class="info-label">Date</div><div class="info-value" id="date">---</div></div>
    <div class="info-row"><div class="info-label">Major Records</div><div class="info-value" id="majorDisp">None</div></div>
    <div class="info-row"><div class="info-label">Minor Records</div><div class="info-value" id="minorDisp">None</div></div>
  </div>

  <a href="records.html" class="btn btn-back"><i class="fas fa-chevron-left"></i> &nbsp; Back to Records</a>
</div>

<div class="modal" id="editModal">
  <div class="modal-content">
    <div class="modal-header">
      <i class="fas fa-edit" style="color: var(--warning);"></i>
      <h3>Edit Student Record</h3>
    </div>
    <div class="form-group"><label>Name</label><input type="text" id="editName"></div>
    <div class="form-group"><label>Student #</label><input type="text" id="editStudentNo"></div>
    <div class="form-group"><label>Course</label><input type="text" id="editCourse"></div>
    <div class="form-group"><label>Email</label><input type="email" id="editEmail"></div>
    <div class="form-group"><label>Date</label><input type="date" id="editDate"></div>
    <div class="form-group"><label>Major History (| separator)</label><textarea id="editMajor"></textarea></div>
    <div class="form-group"><label>Minor History (| separator)</label><textarea id="editMinor"></textarea></div>
    <div class="modal-footer">
      <button id="closeEditBtn" class="btn" style="background:linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%); border-bottom:4px solid #94a3b8; color:#1e293b">Cancel</button>
      <button id="saveEditBtn" class="btn btn-edit" style="flex-direction:row; justify-content:center;">Update All</button>
    </div>
  </div>
</div>

<div class="modal" id="addOffenseModal">
  <div class="modal-content">
    <div class="modal-header">
      <i class="fas fa-exclamation-triangle" style="color: var(--success);"></i>
      <h3>New Offense</h3>
    </div>
    <div class="form-group">
      <label>Level</label>
      <select id="offenseType">
        <option value="">Select Level</option>
        <option value="minor">ðŸŸ¡ Minor Offense</option>
        <option value="major">ðŸ”´ Major Offense</option>
      </select>
    </div>
    <div id="majorGroup" class="form-group hidden">
      <label>Violation Description</label>
      <input type="text" id="offenseDescInput" placeholder="e.g. Cheating">
    </div>
    <div id="minorGroup" class="form-group hidden">
      <label>Offense Type</label>
      <select id="offenseDescSelect">
        <option value="">Select Minor</option>
        <option value="NO ID">NO ID</option>
        <option value="NO UNIFORM">NO UNIFORM</option>
        <option value="NO UNIFORM">DRESS CODE</option>
        <option value="NO UNIFORM">HAIR COLOR</option>
        <option value="NO UNIFORM">PIERCINGS</option>
        <option value="MISCONDUCT">MISCONDUCT</option>
        <option value="Others">Others</option>
      </select>
      <input type="text" id="offenseMinorOther" class="hidden" placeholder="Specify..." style="margin-top:10px;">
    </div>
    <div class="form-group"><label>Date</label><input type="date" id="offenseDate"></div>
    <div class="modal-footer">
      <button id="cancelOffenseBtn" class="btn" style="background:linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%); border-bottom:4px solid #94a3b8; color:#1e293b">Cancel</button>
      <button id="saveOffenseBtn" class="btn btn-add" style="flex-direction:row; justify-content:center;">Save</button>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getFirestore, doc, getDoc, updateDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDFT7z-AmRLu8lig84D_tKA9OhF7joW9c0",
  authDomain: "sasosystem-206d0.firebaseapp.com",
  projectId: "sasosystem-206d0"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const $ = id => document.getElementById(id);
const currentId = new URLSearchParams(window.location.search).get("id");
if(!currentId) location.href="records.html";

let studentData = {};

// Set today's date as default for offense form
$("offenseDate").valueAsDate = new Date();

// Function to format date as MONTH - DAY - YEAR
function formatDateToMonthDayYear(date) {
  const monthNames = [
    "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December"
  ];
  
  const month = monthNames[date.getMonth()];
  const day = date.getDate();
  const year = date.getFullYear();
  
  return `${month} - ${day} - ${year}`;
}

// Function to parse MONTH - DAY - YEAR back to Date object
function parseMonthDayYearToDate(dateString) {
  if (!dateString || dateString.trim() === "") return null;
  
  try {
    const parts = dateString.split(" - ");
    if (parts.length !== 3) return new Date(dateString);
    
    const monthNames = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];
    
    const month = monthNames.indexOf(parts[0]);
    const day = parseInt(parts[1]);
    const year = parseInt(parts[2]);
    
    if (month === -1 || isNaN(day) || isNaN(year)) {
      return new Date(dateString);
    }
    
    return new Date(year, month, day);
  } catch (e) {
    return new Date(dateString);
  }
}

// FIXED Function to format date in offense entries
function formatOffenseDate(dateStr) {
  try {
    // Check if it's already in the correct format (Month - Day - Year)
    const monthNames = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];
    
    // If it's already in "Month - Day - Year" format, return it as is
    const parts = dateStr.split(" - ");
    if (parts.length === 3 && monthNames.includes(parts[0])) {
      return dateStr; // Already formatted correctly
    }
    
    // Try to parse as a date string (YYYY-MM-DD or other date format)
    const date = new Date(dateStr);
    if (!isNaN(date.getTime())) {
      return formatDateToMonthDayYear(date);
    }
    
    // If we can't parse it, return the original string
    return dateStr;
  } catch (e) {
    // If there's an error, return the original string
    return dateStr;
  }
}

async function loadStudent(){
  const snap = await getDoc(doc(db,"studentRecords",currentId));
  if(!snap.exists()) return;
  
  studentData = snap.data();
  $("studentIdDisplay").textContent = "ID: " + currentId;
  $("name").textContent = studentData.name || "---";
  $("student_number").textContent = studentData.student_number || "---";
  $("course").textContent = studentData.course || "---";
  $("cca_email").textContent = studentData.cca_email || "---";
  
  // Format and display date in MONTH - DAY - YEAR format
  if(studentData.date) {
    try {
      // Check if it's already a formatted string or Firestore timestamp
      if (typeof studentData.date === 'string') {
        // It's already a formatted string, just display it
        $("date").textContent = studentData.date;
      } else if (studentData.date.toDate) {
        // It's a Firestore timestamp
        const dateObj = studentData.date.toDate();
        $("date").textContent = formatDateToMonthDayYear(dateObj);
      } else {
        // Try to parse as Date
        const dateObj = new Date(studentData.date);
        $("date").textContent = formatDateToMonthDayYear(dateObj);
      }
    } catch (e) {
      $("date").textContent = studentData.date || "---";
    }
  } else {
    $("date").textContent = "---";
  }
  
  // Format major and minor records with proper date formatting
  const formatOffenseList = (offenseStr) => {
    if (!offenseStr || offenseStr.trim() === "") return "None";
    
    return offenseStr.split('|')
      .filter(Boolean)
      .map(entry => {
        // Check if entry contains date in parentheses
        const match = entry.match(/^(.*?)\s*\((.*?)\)$/);
        if (match) {
          const [_, description, dateStr] = match;
          try {
            // Use the FIXED formatOffenseDate function
            const formattedDate = formatOffenseDate(dateStr.trim());
            return `${description.trim()} (${formattedDate})`;
          } catch (e) {
            return entry.trim();
          }
        }
        return entry.trim();
      })
      .join(", ");
  };
  
  $("majorDisp").textContent = formatOffenseList(studentData.major);
  $("minorDisp").textContent = formatOffenseList(studentData.minor);
  
  const mj = countOffenses(studentData.major);
  const mn = countOffenses(studentData.minor);
  $("majorCount").textContent = mj;
  $("minorCount").textContent = mn;
  $("totalCount").textContent = mj + mn;
}

function countOffenses(str) {
  if (!str || str.trim() === "") return 0;
  return str.split("|").filter(s => s.trim() !== "").length;
}

// Edit Record Logic
$("editRecordBtn").onclick = () => {
  $("editName").value = studentData.name || "";
  $("editStudentNo").value = studentData.student_number || "";
  $("editCourse").value = studentData.course || "";
  $("editEmail").value = studentData.cca_email || "";
  
  // Set date in edit modal
  let dateForInput = "";
  if(studentData.date) {
    try {
      if (typeof studentData.date === 'string') {
        // Parse the formatted string back to Date for input[type="date"]
        const dateObj = parseMonthDayYearToDate(studentData.date);
        if (dateObj && !isNaN(dateObj.getTime())) {
          dateForInput = dateObj.toISOString().split('T')[0];
        }
      } else if (studentData.date.toDate) {
        // It's a Firestore timestamp
        const dateObj = studentData.date.toDate();
        dateForInput = dateObj.toISOString().split('T')[0];
      } else {
        // Try to parse as Date
        const dateObj = new Date(studentData.date);
        if (!isNaN(dateObj.getTime())) {
          dateForInput = dateObj.toISOString().split('T')[0];
        }
      }
    } catch (e) {
      console.error("Error parsing date:", e);
    }
  }
  
  $("editDate").value = dateForInput;
  $("editMajor").value = studentData.major || "";
  $("editMinor").value = studentData.minor || "";
  $("editModal").style.display = "flex";
};

$("closeEditBtn").onclick = () => $("editModal").style.display = "none";

$("saveEditBtn").onclick = async () => {
  const mj = $("editMajor").value.trim();
  const mn = $("editMinor").value.trim();
  
  // Handle date - convert to MONTH - DAY - YEAR format before saving
  let dateValue = $("editDate").value;
  let dateToSave = "";
  
  if (dateValue) {
    const dateObj = new Date(dateValue);
    if (!isNaN(dateObj.getTime())) {
      dateToSave = formatDateToMonthDayYear(dateObj);
    } else {
      dateToSave = dateValue; // Fallback to raw value
    }
  }
  
  const updated = {
    name: $("editName").value,
    student_number: $("editStudentNo").value,
    course: $("editCourse").value,
    cca_email: $("editEmail").value,
    date: dateToSave, // Save as formatted string
    major: mj,
    minor: mn,
    offense_count: countOffenses(mj) + countOffenses(mn),
    last_updated: serverTimestamp()
  };
  
  try {
    await updateDoc(doc(db, "studentRecords", currentId), updated);
    $("editModal").style.display = "none";
    alert("Record updated successfully!");
    loadStudent();
  } catch (error) {
    console.error("Error updating document:", error);
    alert("Error updating record. Please try again.");
  }
};

// Add Offense Logic
$("offenseType").onchange = (e) => {
  $("majorGroup").classList.toggle("hidden", e.target.value !== "major");
  $("minorGroup").classList.toggle("hidden", e.target.value !== "minor");
};

$("offenseDescSelect").onchange = (e) => $("offenseMinorOther").classList.toggle("hidden", e.target.value !== "Others");

$("addOffenseBtn").onclick = () => {
  // Reset form
  $("offenseType").value = "";
  $("offenseDescInput").value = "";
  $("offenseDescSelect").value = "";
  $("offenseMinorOther").value = "";
  $("offenseDate").valueAsDate = new Date();
  $("majorGroup").classList.add("hidden");
  $("minorGroup").classList.add("hidden");
  
  $("addOffenseModal").style.display="flex";
};

$("cancelOffenseBtn").onclick = () => $("addOffenseModal").style.display="none";

$("saveOffenseBtn").onclick = async () => {
  const type = $("offenseType").value;
  const dateStr = $("offenseDate").value;
  let desc = type === 'major' ? $("offenseDescInput").value.trim() : $("offenseDescSelect").value;
  
  if (desc === 'Others') desc = $("offenseMinorOther").value.trim();
  
  if (!type || !dateStr || !desc) return alert("Please fill all fields.");
  
  // Format the date for the offense entry
  const formattedDate = formatOffenseDate(dateStr);
  const entry = `${desc} (${formattedDate})`;
  
  let newMj = studentData.major || "";
  let newMn = studentData.minor || "";
  
  if (type === 'major') newMj = newMj ? newMj + "|" + entry : entry;
  else newMn = newMn ? newMn + "|" + entry : entry;
  
  await updateDoc(doc(db, "studentRecords", currentId), {
    major: newMj,
    minor: newMn,
    offense_count: countOffenses(newMj) + countOffenses(newMn),
    last_updated: serverTimestamp()
  });
  
  $("addOffenseModal").style.display = "none";
  loadStudent();
};

$("deleteRecordBtn").onclick = async () => {
  if(confirm("Delete this student permanently?")) {
    await deleteDoc(doc(db,"studentRecords",currentId));
    location.href="records.html";
  }
};

loadStudent();

// Add some interactive animations
document.querySelectorAll('.btn').forEach(btn => {
  btn.addEventListener('mousedown', () => {
    btn.style.transform = 'translateY(1px)';
  });
  btn.addEventListener('mouseup', () => {
    btn.style.transform = 'translateY(-3px)';
  });
  btn.addEventListener('mouseleave', () => {
    btn.style.transform = 'translateY(0)';
  });
});
</script>
</body>
</html>